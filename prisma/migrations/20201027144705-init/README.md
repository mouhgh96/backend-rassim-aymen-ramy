# Migration `20201027144705-init`

This migration has been generated by Gharbi Mohamed at 10/27/2020, 3:47:05 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "User" (
    "id" TEXT NOT NULL,
    "password" TEXT NOT NULL,
    "firstName" TEXT NOT NULL,
    "lastName" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "tel" TEXT NOT NULL,
    "function" TEXT NOT NULL,
    "img" TEXT,
    "grade" INTEGER NOT NULL DEFAULT 0,
    "notifications" TEXT NOT NULL DEFAULT '[]',
PRIMARY KEY ("id")
)

CREATE TABLE "Leave" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "userId" TEXT NOT NULL,
    "leaveDay" DATETIME NOT NULL,
    "duration" INTEGER NOT NULL,
    "description" TEXT NOT NULL,
    "state" INTEGER NOT NULL DEFAULT 0,
    "motif" TEXT,
    "destination" TEXT NOT NULL,
    "updatedAt" DATETIME NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Exit" (
    "id" INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,
    "exitHour" INTEGER NOT NULL,
    "returnHour" INTEGER NOT NULL,
    "exitDay" DATETIME NOT NULL,
    "description" TEXT NOT NULL,
    "userId" TEXT NOT NULL,
    "state" INTEGER NOT NULL DEFAULT 0,
    "motif" TEXT,
    "destination" TEXT NOT NULL,
    "updatedAt" DATETIME NOT NULL,
    "createdAt" DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,

    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE
)

CREATE TABLE "Token" (
    "value" TEXT NOT NULL,
    "userId" TEXT NOT NULL,

    FOREIGN KEY ("userId") REFERENCES "User"("id") ON DELETE CASCADE ON UPDATE CASCADE,
PRIMARY KEY ("value")
)
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201027144705-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,61 @@
+datasource db {
+  provider = "sqlite"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+  previewFeatures = ["connectOrCreate"]
+}
+
+model User {
+  id        String  @id 
+  password  String
+  firstName String
+  lastName  String
+  email     String
+  tel       String
+  function  String
+  img       String?
+  grade     Int     @default(0)
+  leaves    Leave[]
+  exits     Exit[]
+  notifications  String @default("[]")
+  tokens    Token[]
+}
+
+model Leave {
+  id          Int     @id @default(autoincrement())
+  userId      String
+  user        User        @relation(fields: [userId], references: [id])
+  leaveDay    DateTime
+  duration    Int 
+  description String
+  state       Int      @default(0) 
+  motif       String?
+  destination String
+
+  updatedAt   DateTime @updatedAt
+  createdAt   DateTime @default(now())
+}
+model Exit {
+  id          Int      @id @default(autoincrement())
+  exitHour    Int
+  returnHour  Int
+  exitDay     DateTime
+  description String
+  userId      String
+  user        User     @relation(fields: [userId], references: [id])
+  state       Int      @default(0) 
+  motif       String?
+  destination String
+
+  updatedAt   DateTime @updatedAt
+  createdAt   DateTime @default(now())
+}
+
+model Token {
+  value       String  @id
+  userId      String
+  user        User     @relation(fields: [userId], references: [id])
+}
```


